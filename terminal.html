<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>黑白CRT终端</title>
<style>
  body {
    background: black;
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .crt {
    width: 90vw;
    height: 80vh;
    background: black;
    color: #eeeeee; /* 白色文字 */
    font-family: monospace;
    font-size: 20px;
    line-height: 1.5;
    padding: 20px;
    box-shadow: inset 0 0 30px #666;
    border-radius: 10px;
    overflow-y: auto;
    position: relative;
    text-shadow: 0 0 2px #aaa; /* 微弱灰色发光 */
    opacity: 0; /* 开机前黑屏 */
  }

  /* 扫描线 */
  .crt::before {
    content: "";
    position: absolute;
    inset: 0;
    background: repeating-linear-gradient(
      to bottom,
      rgba(255, 255, 255, 0.05) 0px,
      rgba(255, 255, 255, 0.05) 2px,
      transparent 2px,
      transparent 4px
    );
    pointer-events: none;
  }

  /* 屏幕轻微闪烁 */
  .crt {
    animation: flicker 1.5s infinite;
  }
  @keyframes flicker {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.97; }
  }

  /* 光标闪烁（白色方块） */
  .cursor {
    display: inline-block;
    width: 10px;
    background: #ffffff;
    margin-left: 2px;
    animation: blink 1s step-start infinite;
  }
  @keyframes blink {
    50% { background: transparent; }
  }
</style>
</head>
<body>
  <div class="crt" id="terminal"></div>

<script>
const terminal = document.getElementById("terminal");
let buffer = "";

// === 打字机效果 ===
function typeLine(text, callback, speed = 40) {
  let i = 0;
  const line = document.createElement("div");
  terminal.appendChild(line);

  function typing() {
    line.textContent += text[i];
    i++;
    terminal.scrollTop = terminal.scrollHeight;
    if (i < text.length) {
      setTimeout(typing, speed);
    } else if (callback) {
      callback();
    }
  }
  typing();
}

// === 新提示符 ===
function newPrompt() {
  const oldCursor = terminal.querySelector(".cursor");
  if (oldCursor) oldCursor.remove();

  const prompt = document.createElement("div");
  prompt.innerHTML = `C:\\> <span id="input"></span><span class="cursor"></span>`;
  terminal.appendChild(prompt);

  terminal.scrollTop = terminal.scrollHeight;
}

// === 命令处理 ===
function processCommand(cmd) {
  cmd = cmd.trim();
  const inputs = terminal.querySelectorAll("#input");
  const inputEl = inputs[inputs.length - 1];
  if (inputEl) {
    const parent = inputEl.parentNode;
    const cursor = parent.querySelector(".cursor");
    if (cursor) cursor.remove();
    parent.innerHTML = `C:\\> ${cmd}`;
  }

  const line = document.createElement("div");
  switch (cmd.toLowerCase()) {
    case "help":
      line.textContent = "Commands: help, hello, clear, kaomoji";
      break;
    case "hello":
      line.textContent = "Hello, User (^-^)/";
      break;
    case "kaomoji":
      line.textContent = "(>_<) (o_o) (¬_¬) (◕‿◕✿)";
      break;
    case "clear":
      terminal.innerHTML = "";
      newPrompt();
      buffer = "";
      return;
    case "":
      line.textContent = "";
      break;
    default:
      line.textContent = `'${cmd}' is not recognized.`;
  }
  terminal.appendChild(line);

  newPrompt();
  buffer = "";
}

// === 键盘输入 ===
document.addEventListener("keydown", e => {
  const inputs = terminal.querySelectorAll("#input");
  const inputEl = inputs[inputs.length - 1];
  if (!inputEl) return;

  if (e.key === "Backspace") {
    buffer = buffer.slice(0, -1);
  } else if (e.key === "Enter") {
    processCommand(buffer);
  } else if (e.key.length === 1) {
    buffer += e.key;
  }
  inputEl.textContent = buffer;
});

// === 开机闪屏 ===
function bootSequence() {
  let flashes = 0;
  const interval = setInterval(() => {
    terminal.style.opacity = terminal.style.opacity === "1" ? "0" : "1";
    flashes++;
    if (flashes > 5) {
      clearInterval(interval);
      terminal.style.opacity = "1";
      startTerminal();
    }
  }, 300);
}

// === DOS 欢迎信息 ===
function startTerminal() {
  typeLine("MS-DOS Monochrome v1.0", () => {
    typeLine("C:\\> Type 'help' for commands.", () => {
      newPrompt();
    });
  });
}

bootSequence();
</script>
</body>
</html>
